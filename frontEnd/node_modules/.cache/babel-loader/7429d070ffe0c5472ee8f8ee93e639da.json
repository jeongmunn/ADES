{"ast":null,"code":"import _classCallCheck from\"C:/Users/khadi/OneDrive/Documents/GitHub/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/khadi/OneDrive/Documents/GitHub/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/khadi/OneDrive/Documents/GitHub/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/khadi/OneDrive/Documents/GitHub/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import axios from'axios';import{store}from'react-notifications-component';import Button from'react-bootstrap/Button';import Card from'react-bootstrap/Card';import{Row,Col}from'react-bootstrap';import StudentNavigation from'./StudentNavigaton';import{signOut}from\"firebase/auth\";import{auth}from'../firebase.js';import'../css/navigation.css';import'../css/studentReward.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var viewReward=/*#__PURE__*/function(_React$Component){_inherits(viewReward,_React$Component);var _super=_createSuper(viewReward);function viewReward(){var _this;_classCallCheck(this,viewReward);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:[],currentPts:0,rewardName:'',rewardPoints:0,url:'',studentID:1,uid:'',id:0};_this.handleRedeem=function(event){// Get the data\nvar rewardID=event.target.getAttribute(\"data-index\");var ptsRequired=event.target.getAttribute(\"data-points\");var rewardName=event.target.getAttribute(\"data-name\");console.log(\"rewardID = \"+rewardID);console.log(\"rewardName = \"+rewardName);console.log(\"points = \"+ptsRequired);// Store student's points\nvar currentPts=_this.state.currentPts;// IF student have enough points to redeem\nif(currentPts>=ptsRequired){// Do the calculation\n_this.setState({currentPts:currentPts-ptsRequired});// Insert reward history\nvar IDs={studentID:_this.state.id,rewardID:rewardID};var config={headers:{'content-type':'application/json'}};axios.post('https://ades-ca1-project.herokuapp.com/api/rewardHistory',IDs,config).then(function(res){console.log(res);console.log(res.data);});// Update student's current points\nvar points={points:currentPts};axios.put('https://ades-ca1-project.herokuapp.com/api/point/'+_this.state.id,points,config).then(function(res){console.log(res);console.log(res.data);_this.notiRedeemSuccess(rewardName);});// ELSE student dont have enough points\n}else{_this.notifRedeemFail();}};return _this;}_createClass(viewReward,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;// Auth\nauth.onAuthStateChanged(function(user){// IF there's user\nif(user){console.log(\"User is Signed IN \");_this2.setState({uid:user.uid});var config={headers:{'content-type':'application/json'}};// Get the user type\naxios.get(\"https://ades-ca1-project.herokuapp.com/api/userType/\"+_this2.state.uid,config).then(function(res){// IF is student\nif(res.data.type===1){_this2.setState({id:res.data.studentID});// Get all rewards data\naxios.get('https://ades-ca1-project.herokuapp.com/api/rewards').then(function(res){_this2.setState({data:res.data});});// Get student's points data\naxios.get('https://ades-ca1-project.herokuapp.com/api/points/'+_this2.state.id).then(function(res){_this2.setState({currentPts:res.data[0].redeemedPts});});// IF is teacher\n}else if(res.data.type===2){window.location.replace('https://ades-ca1-project.herokuapp.com/quizment/teacherDashboard');// ELSE kick them out\n}else{window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');}});// ELSE kick them out\n}else{console.log(\"THERE IS NO USER\");signOut(auth);window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');}});}},{key:\"notiRedeemSuccess\",value:function notiRedeemSuccess(rewardName){store.addNotification({title:\"Success\",message:\"Congratulations! You've successfully redeemed \"+rewardName+\" !\",type:\"success\",insert:\"top\",container:\"top-center\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeOut\"],dismiss:{duration:2000},dismissable:{click:true}});}},{key:\"notifRedeemFail\",value:function notifRedeemFail(){store.addNotification({title:\"Error\",message:\"You've insufficient points to redeem this reward. Work harder!\",type:\"danger\",insert:\"top\",container:\"top-center\",animationIn:[\"animated\",\"bounceIn\"],animationOut:[\"animated\",\"bounceOut\"],dismiss:{duration:2000},dismissable:{click:true}});}},{key:\"render\",value:function render(){var _this3=this;var data=this.state.data;return/*#__PURE__*/_jsxs(\"div\",{className:\"StudentReward\",children:[/*#__PURE__*/_jsx(StudentNavigation,{className:\"navBar\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Rewards\"}),/*#__PURE__*/_jsx(\"div\",{className:\"Rewards\",children:/*#__PURE__*/_jsx(Row,{xs:1,md:2,lg:3,className:\"g-4\",children:data&&data.map(function(item){return/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{border:\"warning\",children:[/*#__PURE__*/_jsx(Card.Img,{className:\"cardPic\",variant:\"top\",src:item.url}),/*#__PURE__*/_jsxs(Card.Body,{className:\"cardBody\",children:[/*#__PURE__*/_jsx(Card.Title,{children:item.rewardName}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"Points : \",item.ptsRequired]}),/*#__PURE__*/_jsx(Button,{variant:\"warning\",onClick:_this3.handleRedeem,\"data-index\":item.rewardID,\"data-name\":item.rewardName,\"data-points\":item.ptsRequired,children:\"Redeem\"})]})]})});})})})]});}}]);return viewReward;}(React.Component);export{viewReward as default};","map":{"version":3,"sources":["C:/Users/khadi/OneDrive/Documents/GitHub/ADES/frontEnd/src/components/StudentReward.js"],"names":["React","axios","store","Button","Card","Row","Col","StudentNavigation","signOut","auth","viewReward","state","data","currentPts","rewardName","rewardPoints","url","studentID","uid","id","handleRedeem","event","rewardID","target","getAttribute","ptsRequired","console","log","setState","IDs","config","headers","post","then","res","points","put","notiRedeemSuccess","notifRedeemFail","onAuthStateChanged","user","get","type","redeemedPts","window","location","replace","addNotification","title","message","insert","container","animationIn","animationOut","dismiss","duration","dismissable","click","map","item","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport axios from 'axios';\r\nimport { store } from 'react-notifications-component';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Card from 'react-bootstrap/Card';\r\nimport { Row, Col } from 'react-bootstrap';\r\nimport StudentNavigation from './StudentNavigaton';\r\nimport { signOut } from \"firebase/auth\";\r\nimport { auth } from '../firebase.js';\r\nimport '../css/navigation.css';\r\nimport '../css/studentReward.css';\r\n\r\nexport default class viewReward extends React.Component {\r\n  state = {\r\n    data: [],\r\n    currentPts: 0,\r\n    rewardName: '',\r\n    rewardPoints: 0,\r\n    url: '',\r\n    studentID: 1,\r\n    uid: '',\r\n    id: 0\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Auth\r\n    auth.onAuthStateChanged((user) => {\r\n      // IF there's user\r\n      if (user) {\r\n        console.log(\"User is Signed IN \");\r\n        this.setState({ uid: user.uid });\r\n        const config = {\r\n          headers: {\r\n            'content-type': 'application/json'\r\n          }\r\n        }\r\n\r\n        // Get the user type\r\n        axios.get(`https://ades-ca1-project.herokuapp.com/api/userType/` + this.state.uid, config)\r\n          .then(res => {\r\n            // IF is student\r\n            if (res.data.type === 1) {\r\n              this.setState({ id: res.data.studentID })\r\n              \r\n              // Get all rewards data\r\n              axios.get('https://ades-ca1-project.herokuapp.com/api/rewards')\r\n                .then(res => {\r\n                  this.setState({ data: res.data });\r\n                })\r\n\r\n              // Get student's points data\r\n              axios.get('https://ades-ca1-project.herokuapp.com/api/points/' + this.state.id)\r\n                .then(res => {\r\n                  this.setState({ currentPts: res.data[0].redeemedPts });\r\n                })\r\n              // IF is teacher\r\n            } else if (res.data.type === 2) {\r\n              window.location.replace('https://ades-ca1-project.herokuapp.com/quizment/teacherDashboard');\r\n              // ELSE kick them out\r\n            } else {\r\n              window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');\r\n            }\r\n          })\r\n        // ELSE kick them out\r\n      } else {\r\n        console.log(\"THERE IS NO USER\");\r\n        signOut(auth);\r\n        window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');\r\n      }\r\n    });\r\n  }\r\n\r\n  notiRedeemSuccess(rewardName) {\r\n    store.addNotification({\r\n      title: \"Success\",\r\n      message: \"Congratulations! You've successfully redeemed \" + rewardName + \" !\",\r\n      type: \"success\",\r\n      insert: \"top\",\r\n      container: \"top-center\",\r\n      animationIn: [\"animated\", \"fadeIn\"],\r\n      animationOut: [\"animated\", \"fadeOut\"],\r\n      dismiss: { duration: 2000 },\r\n      dismissable: { click: true }\r\n    });\r\n  }\r\n\r\n  notifRedeemFail() {\r\n    store.addNotification({\r\n      title: \"Error\",\r\n      message: \"You've insufficient points to redeem this reward. Work harder!\",\r\n      type: \"danger\",\r\n      insert: \"top\",\r\n      container: \"top-center\",\r\n      animationIn: [\"animated\", \"bounceIn\"],\r\n      animationOut: [\"animated\", \"bounceOut\"],\r\n      dismiss: { duration: 2000 },\r\n      dismissable: { click: true }\r\n    });\r\n  }\r\n\r\n  handleRedeem = event => {\r\n\r\n    // Get the data\r\n    const rewardID = event.target.getAttribute(\"data-index\");\r\n    const ptsRequired = event.target.getAttribute(\"data-points\");\r\n    const rewardName = event.target.getAttribute(\"data-name\");\r\n    console.log(\"rewardID = \" + rewardID);\r\n    console.log(\"rewardName = \" + rewardName);\r\n    console.log(\"points = \" + ptsRequired);\r\n\r\n    // Store student's points\r\n    const currentPts = this.state.currentPts;\r\n\r\n    // IF student have enough points to redeem\r\n    if (currentPts >= ptsRequired) {\r\n\r\n      // Do the calculation\r\n      this.setState({ currentPts: (currentPts - ptsRequired) });\r\n\r\n      // Insert reward history\r\n      const IDs = {\r\n        studentID: this.state.id,\r\n        rewardID: rewardID\r\n      }\r\n\r\n      const config = {\r\n        headers: {\r\n          'content-type': 'application/json'\r\n        }\r\n      }\r\n\r\n      axios.post('https://ades-ca1-project.herokuapp.com/api/rewardHistory', IDs, config)\r\n        .then(res => {\r\n          console.log(res);\r\n          console.log(res.data);\r\n        })\r\n\r\n      // Update student's current points\r\n      const points = {\r\n        points: currentPts\r\n      }\r\n\r\n      axios.put('https://ades-ca1-project.herokuapp.com/api/point/' + this.state.id, points, config)\r\n        .then(res => {\r\n          console.log(res);\r\n          console.log(res.data);\r\n          this.notiRedeemSuccess(rewardName);\r\n        })\r\n\r\n      // ELSE student dont have enough points\r\n    } else {\r\n      this.notifRedeemFail();\r\n    }\r\n\r\n  }\r\n\r\n  render() {\r\n    const data = this.state.data;\r\n    return (\r\n      <div className=\"StudentReward\">\r\n        <StudentNavigation  className=\"navBar\">\r\n      </StudentNavigation>\r\n        <h1>Rewards</h1>\r\n        <div className=\"Rewards\">\r\n          <Row xs={1} md={2} lg={3} className=\"g-4\">\r\n            {data && data.map(item =>\r\n              <Col>\r\n                <Card border=\"warning\">\r\n                  <Card.Img className=\"cardPic\" variant=\"top\" src={item.url} />\r\n                  <Card.Body className=\"cardBody\">\r\n                    <Card.Title>{item.rewardName}</Card.Title>\r\n                    <Card.Text>Points : {item.ptsRequired}</Card.Text>\r\n                    <Button variant=\"warning\" onClick={this.handleRedeem} data-index={item.rewardID} data-name={item.rewardName} data-points={item.ptsRequired}>Redeem</Button>\r\n                  </Card.Body>\r\n                </Card>\r\n              </Col>\r\n            )}\r\n          </Row>\r\n        </div>\r\n      </div>\r\n\r\n    )\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}