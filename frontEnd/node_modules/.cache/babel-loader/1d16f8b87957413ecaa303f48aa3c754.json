{"ast":null,"code":"import _classCallCheck from\"/Users/isaactan17/Desktop/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/isaactan17/Desktop/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/isaactan17/Desktop/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/isaactan17/Desktop/ADES/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import axios from'axios';import{store}from'react-notifications-component';import Button from'react-bootstrap/Button';import Card from'react-bootstrap/Card';import{Row,Col}from'react-bootstrap';import{signOut}from\"firebase/auth\";import{auth}from'../firebase.js';import'../css/studentReward.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var viewReward=/*#__PURE__*/function(_React$Component){_inherits(viewReward,_React$Component);var _super=_createSuper(viewReward);function viewReward(){var _this;_classCallCheck(this,viewReward);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:[],currentPts:0,rewardName:'',rewardPoints:0,url:'',studentID:1,uid:'',id:0};_this.handleRedeem=function(event){// Get the data\nvar rewardID=event.target.getAttribute(\"data-index\");var ptsRequired=event.target.getAttribute(\"data-points\");var rewardName=event.target.getAttribute(\"data-name\");console.log(\"rewardID = \"+rewardID);console.log(\"rewardName = \"+rewardName);console.log(\"points = \"+ptsRequired);// Store student's points\nvar currentPts=_this.state.currentPts;// IF student have enough points to redeem\nif(currentPts>=ptsRequired){// Do the calculation\n_this.setState({currentPts:currentPts-ptsRequired});// Insert reward history\nvar IDs={studentID:_this.state.id,rewardID:rewardID};var config={headers:{'content-type':'application/json'}};axios.post('https://ades-ca1-project.herokuapp.com/api/rewardHistory',IDs,config).then(function(res){console.log(res);console.log(res.data);});// Update student's current points\nvar points={points:currentPts};axios.put('https://ades-ca1-project.herokuapp.com/api/point/'+_this.state.id,points,config).then(function(res){console.log(res);console.log(res.data);_this.notiRedeemSuccess(rewardName);});// ELSE student dont have enough points\n}else{_this.notifRedeemFail();}};return _this;}_createClass(viewReward,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;// Auth\nauth.onAuthStateChanged(function(user){// IF there's user\nif(user){console.log(\"User is Signed IN \");_this2.setState({uid:user.uid});var config={headers:{'content-type':'application/json'}};// Get the user type\naxios.get(\"https://ades-ca1-project.herokuapp.com/api/userType/\"+_this2.state.uid,config).then(function(res){// IF is student\nif(res.data.type===1){_this2.setState({id:res.data.studentID});// Get all rewards data\naxios.get('https://ades-ca1-project.herokuapp.com/api/rewards').then(function(res){_this2.setState({data:res.data});});// Get student's points data\naxios.get('https://ades-ca1-project.herokuapp.com/api/points/'+_this2.state.id).then(function(res){_this2.setState({currentPts:res.data[0].redeemedPts});});// IF is teacher\n}else if(res.data.type===2){window.location.replace('https://ades-ca1-project.herokuapp.com/quizment/teacherDashboard');// ELSE kick them out\n}else{window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');}});// ELSE kick them out\n}else{console.log(\"THERE IS NO USER\");signOut(auth);window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');}});}},{key:\"notiRedeemSuccess\",value:function notiRedeemSuccess(rewardName){store.addNotification({title:\"Success\",message:\"Congratulations! You've successfully redeemed \"+rewardName+\" !\",type:\"success\",insert:\"top\",container:\"top-center\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeOut\"],dismiss:{duration:2000},dismissable:{click:true}});}},{key:\"notifRedeemFail\",value:function notifRedeemFail(){store.addNotification({title:\"Error\",message:\"You've insufficient points to redeem this reward. Work harder!\",type:\"danger\",insert:\"top\",container:\"top-center\",animationIn:[\"animated\",\"bounceIn\"],animationOut:[\"animated\",\"bounceOut\"],dismiss:{duration:2000},dismissable:{click:true}});}},{key:\"render\",value:function render(){var _this3=this;var data=this.state.data;return/*#__PURE__*/_jsxs(\"div\",{className:\"StudentReward\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Rewards\"}),/*#__PURE__*/_jsx(\"div\",{className:\"Rewards\",children:/*#__PURE__*/_jsx(Row,{xs:1,md:2,lg:3,className:\"g-4\",children:data&&data.map(function(item){return/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{border:\"warning\",children:[/*#__PURE__*/_jsx(Card.Img,{className:\"cardPic\",variant:\"top\",src:item.url}),/*#__PURE__*/_jsxs(Card.Body,{className:\"cardBody\",children:[/*#__PURE__*/_jsx(Card.Title,{children:item.rewardName}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"Points : \",item.ptsRequired]}),/*#__PURE__*/_jsx(Button,{variant:\"warning\",onClick:_this3.handleRedeem,\"data-index\":item.rewardID,\"data-name\":item.rewardName,\"data-points\":item.ptsRequired,children:\"Redeem\"})]})]})});})})})]});}}]);return viewReward;}(React.Component);export{viewReward as default};","map":{"version":3,"sources":["/Users/isaactan17/Desktop/ADES/frontEnd/src/components/StudentReward.js"],"names":["React","axios","store","Button","Card","Row","Col","signOut","auth","viewReward","state","data","currentPts","rewardName","rewardPoints","url","studentID","uid","id","handleRedeem","event","rewardID","target","getAttribute","ptsRequired","console","log","setState","IDs","config","headers","post","then","res","points","put","notiRedeemSuccess","notifRedeemFail","onAuthStateChanged","user","get","type","redeemedPts","window","location","replace","addNotification","title","message","insert","container","animationIn","animationOut","dismiss","duration","dismissable","click","map","item","Component"],"mappings":"wmBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,KAAT,KAAsB,+BAAtB,CACA,MAAOC,CAAAA,MAAP,KAAmB,wBAAnB,CACA,MAAOC,CAAAA,IAAP,KAAiB,sBAAjB,CACA,OAASC,GAAT,CAAcC,GAAd,KAAyB,iBAAzB,CACA,OAASC,OAAT,KAAwB,eAAxB,CACA,OAASC,IAAT,KAAqB,gBAArB,CACA,MAAO,0BAAP,C,2FAEqBC,CAAAA,U,uVACnBC,K,CAAQ,CACNC,IAAI,CAAE,EADA,CAENC,UAAU,CAAE,CAFN,CAGNC,UAAU,CAAE,EAHN,CAINC,YAAY,CAAE,CAJR,CAKNC,GAAG,CAAE,EALC,CAMNC,SAAS,CAAE,CANL,CAONC,GAAG,CAAE,EAPC,CAQNC,EAAE,CAAE,CARE,C,OAuFRC,Y,CAAe,SAAAC,KAAK,CAAI,CAEtB;AACA,GAAMC,CAAAA,QAAQ,CAAGD,KAAK,CAACE,MAAN,CAAaC,YAAb,CAA0B,YAA1B,CAAjB,CACA,GAAMC,CAAAA,WAAW,CAAGJ,KAAK,CAACE,MAAN,CAAaC,YAAb,CAA0B,aAA1B,CAApB,CACA,GAAMV,CAAAA,UAAU,CAAGO,KAAK,CAACE,MAAN,CAAaC,YAAb,CAA0B,WAA1B,CAAnB,CACAE,OAAO,CAACC,GAAR,CAAY,cAAgBL,QAA5B,EACAI,OAAO,CAACC,GAAR,CAAY,gBAAkBb,UAA9B,EACAY,OAAO,CAACC,GAAR,CAAY,YAAcF,WAA1B,EAEA;AACA,GAAMZ,CAAAA,UAAU,CAAG,MAAKF,KAAL,CAAWE,UAA9B,CAEA;AACA,GAAIA,UAAU,EAAIY,WAAlB,CAA+B,CAE7B;AACA,MAAKG,QAAL,CAAc,CAAEf,UAAU,CAAGA,UAAU,CAAGY,WAA5B,CAAd,EAEA;AACA,GAAMI,CAAAA,GAAG,CAAG,CACVZ,SAAS,CAAE,MAAKN,KAAL,CAAWQ,EADZ,CAEVG,QAAQ,CAAEA,QAFA,CAAZ,CAKA,GAAMQ,CAAAA,MAAM,CAAG,CACbC,OAAO,CAAE,CACP,eAAgB,kBADT,CADI,CAAf,CAMA7B,KAAK,CAAC8B,IAAN,CAAW,0DAAX,CAAuEH,GAAvE,CAA4EC,MAA5E,EACGG,IADH,CACQ,SAAAC,GAAG,CAAI,CACXR,OAAO,CAACC,GAAR,CAAYO,GAAZ,EACAR,OAAO,CAACC,GAAR,CAAYO,GAAG,CAACtB,IAAhB,EACD,CAJH,EAMA;AACA,GAAMuB,CAAAA,MAAM,CAAG,CACbA,MAAM,CAAEtB,UADK,CAAf,CAIAX,KAAK,CAACkC,GAAN,CAAU,oDAAsD,MAAKzB,KAAL,CAAWQ,EAA3E,CAA+EgB,MAA/E,CAAuFL,MAAvF,EACGG,IADH,CACQ,SAAAC,GAAG,CAAI,CACXR,OAAO,CAACC,GAAR,CAAYO,GAAZ,EACAR,OAAO,CAACC,GAAR,CAAYO,GAAG,CAACtB,IAAhB,EACA,MAAKyB,iBAAL,CAAuBvB,UAAvB,EACD,CALH,EAOA;AACD,CApCD,IAoCO,CACL,MAAKwB,eAAL,GACD,CAEF,C,uEAlID,4BAAoB,iBAClB;AACA7B,IAAI,CAAC8B,kBAAL,CAAwB,SAACC,IAAD,CAAU,CAChC;AACA,GAAIA,IAAJ,CAAU,CACRd,OAAO,CAACC,GAAR,CAAY,oBAAZ,EACA,MAAI,CAACC,QAAL,CAAc,CAAEV,GAAG,CAAEsB,IAAI,CAACtB,GAAZ,CAAd,EACA,GAAMY,CAAAA,MAAM,CAAG,CACbC,OAAO,CAAE,CACP,eAAgB,kBADT,CADI,CAAf,CAMA;AACA7B,KAAK,CAACuC,GAAN,CAAU,uDAAyD,MAAI,CAAC9B,KAAL,CAAWO,GAA9E,CAAmFY,MAAnF,EACGG,IADH,CACQ,SAAAC,GAAG,CAAI,CACX;AACA,GAAIA,GAAG,CAACtB,IAAJ,CAAS8B,IAAT,GAAkB,CAAtB,CAAyB,CACvB,MAAI,CAACd,QAAL,CAAc,CAAET,EAAE,CAAEe,GAAG,CAACtB,IAAJ,CAASK,SAAf,CAAd,EAEA;AACAf,KAAK,CAACuC,GAAN,CAAU,oDAAV,EACGR,IADH,CACQ,SAAAC,GAAG,CAAI,CACX,MAAI,CAACN,QAAL,CAAc,CAAEhB,IAAI,CAAEsB,GAAG,CAACtB,IAAZ,CAAd,EACD,CAHH,EAKA;AACAV,KAAK,CAACuC,GAAN,CAAU,qDAAuD,MAAI,CAAC9B,KAAL,CAAWQ,EAA5E,EACGc,IADH,CACQ,SAAAC,GAAG,CAAI,CACX,MAAI,CAACN,QAAL,CAAc,CAAEf,UAAU,CAAEqB,GAAG,CAACtB,IAAJ,CAAS,CAAT,EAAY+B,WAA1B,CAAd,EACD,CAHH,EAIA;AACD,CAfD,IAeO,IAAIT,GAAG,CAACtB,IAAJ,CAAS8B,IAAT,GAAkB,CAAtB,CAAyB,CAC9BE,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,kEAAxB,EACA;AACD,CAHM,IAGA,CACLF,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,iDAAxB,EACD,CACF,CAxBH,EAyBA;AACD,CApCD,IAoCO,CACLpB,OAAO,CAACC,GAAR,CAAY,kBAAZ,EACAnB,OAAO,CAACC,IAAD,CAAP,CACAmC,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,iDAAxB,EACD,CACF,CA3CD,EA4CD,C,iCAED,2BAAkBhC,UAAlB,CAA8B,CAC5BX,KAAK,CAAC4C,eAAN,CAAsB,CACpBC,KAAK,CAAE,SADa,CAEpBC,OAAO,CAAE,iDAAmDnC,UAAnD,CAAgE,IAFrD,CAGpB4B,IAAI,CAAE,SAHc,CAIpBQ,MAAM,CAAE,KAJY,CAKpBC,SAAS,CAAE,YALS,CAMpBC,WAAW,CAAE,CAAC,UAAD,CAAa,QAAb,CANO,CAOpBC,YAAY,CAAE,CAAC,UAAD,CAAa,SAAb,CAPM,CAQpBC,OAAO,CAAE,CAAEC,QAAQ,CAAE,IAAZ,CARW,CASpBC,WAAW,CAAE,CAAEC,KAAK,CAAE,IAAT,CATO,CAAtB,EAWD,C,+BAED,0BAAkB,CAChBtD,KAAK,CAAC4C,eAAN,CAAsB,CACpBC,KAAK,CAAE,OADa,CAEpBC,OAAO,CAAE,gEAFW,CAGpBP,IAAI,CAAE,QAHc,CAIpBQ,MAAM,CAAE,KAJY,CAKpBC,SAAS,CAAE,YALS,CAMpBC,WAAW,CAAE,CAAC,UAAD,CAAa,UAAb,CANO,CAOpBC,YAAY,CAAE,CAAC,UAAD,CAAa,WAAb,CAPM,CAQpBC,OAAO,CAAE,CAAEC,QAAQ,CAAE,IAAZ,CARW,CASpBC,WAAW,CAAE,CAAEC,KAAK,CAAE,IAAT,CATO,CAAtB,EAWD,C,sBA0DD,iBAAS,iBACP,GAAM7C,CAAAA,IAAI,CAAG,KAAKD,KAAL,CAAWC,IAAxB,CACA,mBACE,aAAK,SAAS,CAAC,eAAf,wBACE,+BADF,cAEE,YAAK,SAAS,CAAC,SAAf,uBACE,KAAC,GAAD,EAAK,EAAE,CAAE,CAAT,CAAY,EAAE,CAAE,CAAhB,CAAmB,EAAE,CAAE,CAAvB,CAA0B,SAAS,CAAC,KAApC,UACGA,IAAI,EAAIA,IAAI,CAAC8C,GAAL,CAAS,SAAAC,IAAI,qBACpB,KAAC,GAAD,wBACE,MAAC,IAAD,EAAM,MAAM,CAAC,SAAb,wBACE,KAAC,IAAD,CAAM,GAAN,EAAU,SAAS,CAAC,SAApB,CAA8B,OAAO,CAAC,KAAtC,CAA4C,GAAG,CAAEA,IAAI,CAAC3C,GAAtD,EADF,cAEE,MAAC,IAAD,CAAM,IAAN,EAAW,SAAS,CAAC,UAArB,wBACE,KAAC,IAAD,CAAM,KAAN,WAAa2C,IAAI,CAAC7C,UAAlB,EADF,cAEE,MAAC,IAAD,CAAM,IAAN,wBAAqB6C,IAAI,CAAClC,WAA1B,GAFF,cAGE,KAAC,MAAD,EAAQ,OAAO,CAAC,SAAhB,CAA0B,OAAO,CAAE,MAAI,CAACL,YAAxC,CAAsD,aAAYuC,IAAI,CAACrC,QAAvE,CAAiF,YAAWqC,IAAI,CAAC7C,UAAjG,CAA6G,cAAa6C,IAAI,CAAClC,WAA/H,oBAHF,GAFF,GADF,EADoB,EAAb,CADX,EADF,EAFF,GADF,CAsBD,C,wBAxKqCxB,KAAK,CAAC2D,S,SAAzBlD,U","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { store } from 'react-notifications-component';\nimport Button from 'react-bootstrap/Button';\nimport Card from 'react-bootstrap/Card';\nimport { Row, Col } from 'react-bootstrap';\nimport { signOut } from \"firebase/auth\";\nimport { auth } from '../firebase.js';\nimport '../css/studentReward.css';\n\nexport default class viewReward extends React.Component {\n  state = {\n    data: [],\n    currentPts: 0,\n    rewardName: '',\n    rewardPoints: 0,\n    url: '',\n    studentID: 1,\n    uid: '',\n    id: 0\n  }\n\n  componentDidMount() {\n    // Auth\n    auth.onAuthStateChanged((user) => {\n      // IF there's user\n      if (user) {\n        console.log(\"User is Signed IN \");\n        this.setState({ uid: user.uid });\n        const config = {\n          headers: {\n            'content-type': 'application/json'\n          }\n        }\n\n        // Get the user type\n        axios.get(`https://ades-ca1-project.herokuapp.com/api/userType/` + this.state.uid, config)\n          .then(res => {\n            // IF is student\n            if (res.data.type === 1) {\n              this.setState({ id: res.data.studentID })\n              \n              // Get all rewards data\n              axios.get('https://ades-ca1-project.herokuapp.com/api/rewards')\n                .then(res => {\n                  this.setState({ data: res.data });\n                })\n\n              // Get student's points data\n              axios.get('https://ades-ca1-project.herokuapp.com/api/points/' + this.state.id)\n                .then(res => {\n                  this.setState({ currentPts: res.data[0].redeemedPts });\n                })\n              // IF is teacher\n            } else if (res.data.type === 2) {\n              window.location.replace('https://ades-ca1-project.herokuapp.com/quizment/teacherDashboard');\n              // ELSE kick them out\n            } else {\n              window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');\n            }\n          })\n        // ELSE kick them out\n      } else {\n        console.log(\"THERE IS NO USER\");\n        signOut(auth);\n        window.location.replace('https://ades-ca1-project.herokuapp.com/quizment');\n      }\n    });\n  }\n\n  notiRedeemSuccess(rewardName) {\n    store.addNotification({\n      title: \"Success\",\n      message: \"Congratulations! You've successfully redeemed \" + rewardName + \" !\",\n      type: \"success\",\n      insert: \"top\",\n      container: \"top-center\",\n      animationIn: [\"animated\", \"fadeIn\"],\n      animationOut: [\"animated\", \"fadeOut\"],\n      dismiss: { duration: 2000 },\n      dismissable: { click: true }\n    });\n  }\n\n  notifRedeemFail() {\n    store.addNotification({\n      title: \"Error\",\n      message: \"You've insufficient points to redeem this reward. Work harder!\",\n      type: \"danger\",\n      insert: \"top\",\n      container: \"top-center\",\n      animationIn: [\"animated\", \"bounceIn\"],\n      animationOut: [\"animated\", \"bounceOut\"],\n      dismiss: { duration: 2000 },\n      dismissable: { click: true }\n    });\n  }\n\n  handleRedeem = event => {\n\n    // Get the data\n    const rewardID = event.target.getAttribute(\"data-index\");\n    const ptsRequired = event.target.getAttribute(\"data-points\");\n    const rewardName = event.target.getAttribute(\"data-name\");\n    console.log(\"rewardID = \" + rewardID);\n    console.log(\"rewardName = \" + rewardName);\n    console.log(\"points = \" + ptsRequired);\n\n    // Store student's points\n    const currentPts = this.state.currentPts;\n\n    // IF student have enough points to redeem\n    if (currentPts >= ptsRequired) {\n\n      // Do the calculation\n      this.setState({ currentPts: (currentPts - ptsRequired) });\n\n      // Insert reward history\n      const IDs = {\n        studentID: this.state.id,\n        rewardID: rewardID\n      }\n\n      const config = {\n        headers: {\n          'content-type': 'application/json'\n        }\n      }\n\n      axios.post('https://ades-ca1-project.herokuapp.com/api/rewardHistory', IDs, config)\n        .then(res => {\n          console.log(res);\n          console.log(res.data);\n        })\n\n      // Update student's current points\n      const points = {\n        points: currentPts\n      }\n\n      axios.put('https://ades-ca1-project.herokuapp.com/api/point/' + this.state.id, points, config)\n        .then(res => {\n          console.log(res);\n          console.log(res.data);\n          this.notiRedeemSuccess(rewardName);\n        })\n\n      // ELSE student dont have enough points\n    } else {\n      this.notifRedeemFail();\n    }\n\n  }\n\n  render() {\n    const data = this.state.data;\n    return (\n      <div className=\"StudentReward\">\n        <h1>Rewards</h1>\n        <div className=\"Rewards\">\n          <Row xs={1} md={2} lg={3} className=\"g-4\">\n            {data && data.map(item =>\n              <Col>\n                <Card border=\"warning\">\n                  <Card.Img className=\"cardPic\" variant=\"top\" src={item.url} />\n                  <Card.Body className=\"cardBody\">\n                    <Card.Title>{item.rewardName}</Card.Title>\n                    <Card.Text>Points : {item.ptsRequired}</Card.Text>\n                    <Button variant=\"warning\" onClick={this.handleRedeem} data-index={item.rewardID} data-name={item.rewardName} data-points={item.ptsRequired}>Redeem</Button>\n                  </Card.Body>\n                </Card>\n              </Col>\n            )}\n          </Row>\n        </div>\n      </div>\n\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}